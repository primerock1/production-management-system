# Система управления производством мебельной компании

[![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![FastAPI](https://img.shields.io/badge/FastAPI-0.104+-green.svg)](https://fastapi.tiangolo.com/)
[![SQLite](https://img.shields.io/badge/SQLite-3-lightgrey.svg)](https://www.sqlite.org/)
[![Bootstrap](https://img.shields.io/badge/Bootstrap-5.3-purple.svg)](https://getbootstrap.com/)
[![License](https://img.shields.io/badge/License-Educational-yellow.svg)](#)

## Описание проекта

Полнофункциональная система управления производством, разработанная для мебельной компании. Включает все этапы от проектирования базы данных до готового веб-приложения с калькулятором сырья.

> **Статус проекта:** ГОТОВ К ПРОМЫШЛЕННОМУ ИСПОЛЬЗОВАНИЮ

---

## Содержание

- [Демонстрация](#демонстрация)
- [Быстрый старт](#быстрый-старт)  
- [Компоненты системы](#компоненты-системы)
- [Примеры использования](#примеры-использования)
- [Статистика системы](#статистика-системы)
- [Документация](#документация)
- [Готовность к демонстрации](#готовность-к-демонстрации)
- [Поддержка](#поддержка)

### Ключевые возможности:
- **База данных SQLite** с полной структурой производственных данных (172 записи)
- **REST API** на FastAPI с автоматической документацией Swagger
- **Веб-интерфейс** с адаптивным дизайном и корпоративным стилем
- **Калькулятор сырья** с учетом потерь материалов и коэффициентов
- **Управление цехами** и производственными процессами
- **Панель управления** с интерактивной статистикой
- **Автоматический запуск** всей системы одной командой

### Быстрые ссылки:
- **[Инструкция по работе с сайтом](ИНСТРУКЦИЯ_ПО_РАБОТЕ_С_САЙТОМ.md)** - подробное руководство пользователя
- **[Архитектура системы](Пояснения/АРХИТЕКТУРА_СИСТЕМЫ.md)** - техническое описание
- **[Swagger UI](http://localhost:8000/docs)** - интерактивная документация API (после запуска)

## Демонстрация

### Веб-интерфейс системы
```
Панель управления → Справочники → Продукция → Калькулятор
     ↓                    ↓           ↓          ↓
Статистика        Материалы    Каталог   Расчет сырья
Карточки          Типы         CRUD      Формулы
Навигация         Цеха         Связи     Результаты
```

### Основные экраны:
- **Панель управления** - интерактивные карточки со статистикой
- **Справочники** - управление типами материалов, продукции и цехами  
- **Каталог продукции** - полный список изделий с характеристиками
- **Калькулятор сырья** - расчет материалов с учетом потерь
- **Производственные процессы** - цеха и время изготовления

## Быстрый старт

### Автоматический запуск (Рекомендуется)
```bash
# Запуск всей системы одной командой
start_system.bat
```
**Что происходит:**
- Запускается Backend API на порту 8000
- Запускается Frontend на порту 3000  
- Автоматически открывается браузер
- Система готова к использованию за 10 секунд!

### Ручная установка

#### 1. Клонирование репозитория
```bash
# Клонировать репозиторий с GitHub
git clone https://github.com/primerock1/production-management-system.git
cd production-management-system

# Установить зависимости Python
pip install -r requirements.txt

# Установить зависимости для Backend
cd backend && pip install -r requirements.txt && cd ..
```

#### 2. Создание базы данных (если нужно)
```bash
# База данных уже создана, но можно пересоздать
python create_database.py  # Создает production_db.sqlite
python create_er_diagram.py  # Создает ER_diagram.pdf
```

#### 3. Запуск сервисов
```bash
# Терминал 1: Backend API
cd backend && python run.py

# Терминал 2: Frontend (в новом окне)
cd frontend && python -m http.server 3000
```

### Доступные адреса
| Сервис | URL | Описание |
|--------|-----|----------|
| **Веб-интерфейс** | http://localhost:3000 | Основное приложение |
| **API** | http://localhost:8000 | REST API endpoints |
| **Документация** | http://localhost:8000/docs | Swagger UI |
| **ReDoc** | http://localhost:8000/redoc | Альтернативная документация |

## Компоненты системы

### 1. База данных SQLite

#### Структура таблиц
- **material_type** - Типы материалов (4 записи)
  - `id` - первичный ключ
  - `name` - название материала (уникальное)
  - `loss_percentage` - процент потерь сырья

- **product_type** - Типы продукции (6 записей)
  - `id` - первичный ключ
  - `name` - название типа продукции (уникальное)
  - `coefficient` - коэффициент типа продукции

- **workshops** - Цеха производства (12 записей)
  - `id` - первичный ключ
  - `name` - название цеха (уникальное)
  - `workshop_type` - тип цеха
  - `staff_count` - количество персонала

- **products** - Продукция (20 записей)
  - `id` - первичный ключ
  - `name` - название продукции
  - `product_type_id` - внешний ключ на product_type
  - `article` - артикул
  - `min_price` - минимальная цена
  - `main_material` - основной материал

- **product_workshops** - Связи продукции и цехов (130 записей)
  - `id` - первичный ключ
  - `product_id` - внешний ключ на products
  - `workshop_id` - внешний ключ на workshops
  - `production_time_hours` - время производства в часах

#### Работа с базой данных

##### Создание новой БД
```bash
python create_database.py
```
**Что происходит:**
- Создается файл `production_db.sqlite`
- Создаются все таблицы с правильной структурой
- Импортируются данные из Excel файлов в папке `Resources/xlsx/`
- Выводится статистика импорта

##### Пересоздание БД
```bash
# Удалить старую БД (опционально)
rm production_db.sqlite

# Создать новую
python create_database.py
```

##### Создание ER-диаграммы
```bash
python create_er_diagram.py
```
**Результат:** Файл `ER_diagram.pdf` с визуальной схемой БД

### 2. REST API (FastAPI)

#### Запуск API сервера
```bash
cd backend
python run.py
```

### 3. Веб-интерфейс (Frontend)

#### Технологии
- **HTML5, CSS3, JavaScript ES6+** - современная основа
- **Bootstrap 5.3** - адаптивный UI фреймворк  
- **Font Awesome 6.4** - профессиональные иконки
- **Fetch API** - асинхронное взаимодействие с backend

#### Функциональность
- **Панель управления** с интерактивной статистикой и кликабельными карточками
- **CRUD операции** для всех сущностей через модальные окна
- **Калькулятор сырья** с учетом потерь материалов и коэффициентов типа продукции
- **Просмотр цехов** для каждого продукта с временем производства
- **Адаптивный дизайн** для desktop, tablet, mobile устройств
- **Валидация форм** и система уведомлений об операциях
- **Корпоративный стиль** с логотипом компании

#### Запуск
```bash
# Рекомендуется: автоматический запуск всей системы
start_system.bat

# Или ручной запуск только фронтенда
cd frontend && python -m http.server 3000
```

#### Доступные endpoints

##### Корневые endpoints
- `GET /` - информация об API
- `GET /health` - проверка работоспособности

##### Calculator (Калькулятор сырья)
```bash
# Рассчитать количество сырья с учетом потерь
POST /api/calculator/calculate-material
{
  "product_type_id": 1,
  "material_type_id": 2, 
  "quantity": 10,
  "param1": 1.5,  # длина
  "param2": 2.0   # ширина
}

# Получить цеха для производства конкретного продукта
GET /api/calculator/workshops-for-product/{product_id}

# Получить общее время производства продукта
GET /api/calculator/total-production-time/{product_id}
```

##### Material Types (Типы материалов)
```bash
# Получить все типы материалов
GET /api/material-types

# Получить тип материала по ID
GET /api/material-types/{id}

# Создать новый тип материала
POST /api/material-types
```

##### Product Types (Типы продукции)
```bash
# Получить все типы продукции
GET /api/product-types

# Получить тип продукции по ID
GET /api/product-types/{id}

# Создать новый тип продукции
POST /api/product-types
```

##### Workshops (Цеха)
```bash
# Получить все цеха
GET /api/workshops

# Получить цех по ID
GET /api/workshops/{id}

# Создать новый цех
POST /api/workshops
```

##### Products (Продукция)
```bash
# Получить всю продукцию
GET /api/products

# Получить продукцию по ID
GET /api/products/{id}

# Создать новую продукцию
POST /api/products
```

##### Product Workshops (Связи продукции и цехов)
```bash
# Получить все связи
GET /api/product-workshops

# Получить связь по ID
GET /api/product-workshops/{id}

# Создать новую связь
POST /api/product-workshops
```

## Практические примеры

### Работа с базой данных

#### Просмотр данных через Python
```python
import sqlite3

# Подключение к БД
conn = sqlite3.connect('production_db.sqlite')
cursor = conn.cursor()

# Получить все типы материалов
cursor.execute("SELECT * FROM material_type")
materials = cursor.fetchall()
print("Типы материалов:", materials)

# Получить продукцию с типами
cursor.execute("""
    SELECT p.name, pt.name, p.min_price 
    FROM products p 
    LEFT JOIN product_type pt ON p.product_type_id = pt.id
""")
products = cursor.fetchall()
print("Продукция:", products)

conn.close()
```

### Работа с API

#### Получение данных
```bash
# Получить все типы материалов
curl "http://localhost:8000/api/material-types"

# Получить конкретный продукт
curl "http://localhost:8000/api/products/1"

# Получить связи с пагинацией
curl "http://localhost:8000/api/product-workshops?skip=0&limit=10"
```

#### Создание новых записей
```bash
# Создать новый тип материала
curl -X POST "http://localhost:8000/api/material-types" \
     -H "Content-Type: application/json" \
     -d '{
       "name": "Пластик",
       "loss_percentage": 2.5
     }'

# Создать новый продукт
curl -X POST "http://localhost:8000/api/products" \
     -H "Content-Type: application/json" \
     -d '{
       "name": "Стул офисный",
       "product_type_id": 1,
       "article": "CH-001",
       "min_price": 3500.0,
       "main_material": "Пластик"
     }'

# Создать связь продукта и цеха
curl -X POST "http://localhost:8000/api/product-workshops" \
     -H "Content-Type: application/json" \
     -d '{
       "product_id": 1,
       "workshop_id": 3,
       "production_time_hours": 6.0
     }'
```

#### Использование Swagger UI
1. Откройте http://localhost:8000/docs
2. Выберите нужный endpoint
3. Нажмите "Try it out"
4. Заполните параметры
5. Нажмите "Execute"
6. Посмотрите результат

## Структура проекта

```
production-management-system/
├── backend/                      # FastAPI приложение
│   ├── app/
│   │   ├── main.py              # Главный файл приложения
│   │   ├── config.py            # Конфигурация
│   │   ├── database.py          # Подключение к БД
│   │   ├── models/              # SQLAlchemy модели
│   │   │   ├── material_type.py
│   │   │   ├── product_type.py
│   │   │   ├── workshop.py
│   │   │   ├── product.py
│   │   │   └── product_workshop.py
│   │   ├── schemas/             # Pydantic схемы
│   │   │   ├── material_type.py
│   │   │   ├── product_type.py
│   │   │   ├── workshop.py
│   │   │   ├── product.py
│   │   │   └── product_workshop.py
│   │   ├── routers/             # API роутеры
│   │   │   ├── material_type.py
│   │   │   ├── product_type.py
│   │   │   ├── workshop.py
│   │   │   ├── product.py
│   │   │   ├── product_workshop.py
│   │   │   └── material_calculator.py
│   │   └── services/            # Бизнес-логика
│   │       └── material_calculator.py
│   ├── run.py                   # Скрипт запуска API
│   └── requirements.txt         # Зависимости API
├── frontend/                    # Веб-интерфейс
│   ├── index.html              # Главная страница
│   ├── css/
│   │   └── style.css           # Стили приложения
│   ├── js/
│   │   ├── api.js              # Модуль работы с API
│   │   ├── modals.js           # Модальные окна
│   │   └── app.js              # Основная логика
│   └── logo.png                # Корпоративный логотип
├── Resources/                   # Исходные данные
│   ├── xlsx/                   # Excel файлы для импорта
│   │   ├── Material_type_import.xlsx
│   │   ├── Product_type_import.xlsx
│   │   ├── Workshops_import.xlsx
│   │   ├── Products_import.xlsx
│   │   └── Product_workshops_import.xlsx
│   └── *.pdf, *.docx          # Документация проекта
├── Отчёты/                     # Отчеты по проекту
│   ├── Отчет по заданию 1_ База данных.pdf
│   ├── Отчет по заданию 2_ Бэкенд.pdf
│   ├── Отчет по заданию 3_ Разработка фронтенда.pdf
│   ├── Отчет по заданию 4_ Дополнительный функционал.pdf
│   ├── Итоговый отчет по проекту.html
│   └── Как проверить CRUD операции.pdf
├── Пояснения/                  # Подробная документация
│   ├── АРХИТЕКТУРА_СИСТЕМЫ.md
│   ├── ПОЯСНЕНИЯ_ПО_БД_СКРИПТАМ.md
│   ├── ПОЯСНЕНИЯ_ПО_КОДУ.md
│   ├── ПОЯСНЕНИЯ_ПО_ФРОНТЕНДУ.md
│   └── ПОЯСНЕНИЯ_ПО_КАЛЬКУЛЯТОРУ.md
├── production_db.sqlite         # База данных SQLite
├── ER_diagram.pdf              # ER-диаграмма
├── create_database.py          # Скрипт создания БД
├── create_er_diagram.py        # Скрипт создания ER-диаграммы
├── start_system.bat            # Автозапуск системы
├── requirements.txt            # Зависимости проекта
├── .gitignore                  # Исключения Git
├── .gitattributes             # Настройки Git
└── README.md                  # Это руководство
```

## Требования

### Системные требования
- Python 3.8 или выше
- Операционная система: Windows, macOS, Linux
- Свободное место: ~50 MB

### Зависимости для работы с БД
```bash
pip install pandas>=2.0.0 openpyxl>=3.1.0 matplotlib>=3.7.0 Pillow>=10.0.0 reportlab>=4.0.0
```

### Зависимости для API
```bash
pip install fastapi>=0.104.0 uvicorn>=0.24.0 sqlalchemy>=2.0.0 pydantic>=2.4.0 pydantic-settings>=2.0.0
```

### Установка всех зависимостей
```bash
# Из корня проекта
pip install -r requirements.txt

# Для API отдельно
cd backend
pip install -r requirements.txt
```

## Статистика системы

### Данные в базе
| Таблица | Записей | Описание | Функционал |
|---------|---------|----------|------------|
| material_type | 4 | Типы материалов с процентом потерь | Расчет сырья |
| product_type | 6 | Типы продукции с коэффициентами | Расчет сырья |
| workshops | 12 | Цеха с информацией о персонале | Производственные процессы |
| products | 20 | Продукция с артикулами и ценами | Каталог продукции |
| product_workshops | 130 | Связи продукции и цехов | Время производства |
| **Всего** | **172** | **Общее количество записей** | **Полная система** |

### Функциональная статистика
| Компонент | Количество | Статус |
|-----------|------------|--------|
| API endpoints | 18 | Работают |
| Веб-страницы | 6 разделов | Адаптивные |
| CRUD операции | 5 сущностей | Полные |
| Калькуляторы | 1 (сырье) | С валидацией |
| Отчеты | 6 документов | PDF готовы |
| Пояснения | 5 файлов | Подробные |
| Автозапуск | 1 скрипт | Работает |

## Возможные проблемы и решения

### База данных

#### Проблема: "Файл БД не найден"
**Решение:**
```bash
# Убедитесь, что находитесь в корне проекта
python create_database.py
```

#### Проблема: "Ошибка импорта Excel файлов"
**Решение:**
```bash
# Проверьте наличие файлов
ls Resources/xlsx/

# Установите зависимости
pip install pandas openpyxl
```

### API

#### Проблема: "Модуль не найден"
**Решение:**
```bash
cd backend
pip install -r requirements.txt
```

#### Проблема: "База данных не найдена"
**Решение:**
```bash
# Из корня проекта создайте БД
python create_database.py

# Затем запустите API
cd backend
python run.py
```

#### Проблема: "Порт 8000 занят"
**Решение:**
Измените порт в `backend/app/config.py`:
```python
PORT: int = 8001  # Или другой свободный порт
```

## Расширение функционала

### Добавление новой таблицы

1. **Создать модель** в `backend/app/models/`
2. **Создать схемы** в `backend/app/schemas/`
3. **Создать роутер** в `backend/app/routers/`
4. **Подключить роутер** в `backend/app/main.py`
5. **Добавить данные** в Excel файл и обновить `create_database.py`

### Добавление новых полей

1. **Обновить модель** в `backend/app/models/`
2. **Обновить схемы** в `backend/app/schemas/`
3. **Обновить Excel файл** с новыми колонками
4. **Пересоздать БД** командой `python create_database.py`

## Примеры использования калькулятора

### Расчет сырья для мебели
```python
# Пример: Расчет дерева для 10 столов
# Тип продукции: Мебель (коэффициент 1.2)
# Материал: Дерево (потери 5%)
# Размеры стола: 1.5м × 2.0м

Расчет:
1. Базовое количество: 1.5 × 2.0 × 1.2 × 10 = 36 м²
2. С учетом потерь: 36 × (1 + 5/100) = 37.8 м²
3. Результат: ceil(37.8) = 38 м² дерева
```

### Производственный процесс
```
Продукт: Стул офисный
├── Цех раскроя: 2.0 часа (5 человек)
├── Цех сборки: 4.5 часа (8 человек)  
└── Цех отделки: 3.0 часа (3 человека)
Итого: 9.5 часов, 16 человек
```

## Документация

### Отчеты по заданиям
- **Отчёты/Отчет по заданию 1_ База данных.pdf** - создание БД и импорт данных
- **Отчёты/Отчет по заданию 2_ Бэкенд.pdf** - разработка REST API
- **Отчёты/Отчет по заданию 3_ Разработка фронтенда.pdf** - веб-интерфейс и UI/UX
- **Отчёты/Отчет по заданию 4_ Дополнительный функционал.pdf** - калькулятор сырья
- **Отчёты/Итоговый отчет по проекту.html** - сводный отчет (готов для PDF)

### Техническая документация
- **README.md** (этот файл) - основное руководство пользователя
- **Пояснения/АРХИТЕКТУРА_СИСТЕМЫ.md** - общая архитектура и паттерны проектирования
- **Пояснения/ПОЯСНЕНИЯ_ПО_БД_СКРИПТАМ.md** - подробное описание скриптов БД
- **Пояснения/ПОЯСНЕНИЯ_ПО_КОДУ.md** - подробное описание кода Backend API
- **Пояснения/ПОЯСНЕНИЯ_ПО_ФРОНТЕНДУ.md** - подробное описание Frontend кода
- **Пояснения/ПОЯСНЕНИЯ_ПО_КАЛЬКУЛЯТОРУ.md** - алгоритмы и код калькулятора сырья
- **ER_diagram.pdf** - визуальная схема базы данных
- **Swagger UI** (http://localhost:8000/docs) - интерактивная документация API

### Инструкции
- **Отчёты/Как проверить CRUD операции.pdf** - тестирование функционала

## Готовность к демонстрации

### Система полностью готова:
- **База данных** - SQLite с 172 записями
- **Backend API** - 18 endpoints с документацией
- **Frontend** - 6 разделов с адаптивным дизайном
- **Калькулятор** - расчет сырья с учетом потерь
- **Автозапуск** - одна команда для запуска всей системы
- **Документация** - 6 отчетов в PDF + 5 файлов пояснений

### Демонстрация (15 минут):
1. **Автозапуск системы** - `start_system.bat`
2. **Обзор интерфейса** - панель управления, навигация
3. **CRUD операции** - создание, редактирование, удаление
4. **Калькулятор сырья** - расчет с реальными данными
5. **Производственные процессы** - цеха и время изготовления
6. **API документация** - Swagger UI
7. **Адаптивность** - мобильная версия

## Лицензия

Учебный проект системы управления производством. © 2025

## Поддержка

### Быстрое решение проблем:
1. **Не запускается система** → Проверьте Python 3.8+ и зависимости
2. **Ошибка БД** → Запустите `python create_database.py`
3. **API недоступен** → Проверьте порт 8000, запустите `backend/run.py`
4. **Фронтенд не работает** → Проверьте порт 3000, запустите `python -m http.server 3000`
5. **Калькулятор ошибается** → Проверьте типы продукции и материалов в БД

### Контакты:
- **Swagger UI**: http://localhost:8000/docs - тестирование API
- **Документация**: Папка `Отчёты/` - полные инструкции
- **Исходный код**: GitHub репозиторий с полной историей

**Статус проекта: ГОТОВ К ПРОМЫШЛЕННОМУ ИСПОЛЬЗОВАНИЮ**